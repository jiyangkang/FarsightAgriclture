Index: app/src/main/res/layout/fragment_voir.xml
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
--- app/src/main/res/layout/fragment_voir.xml	(date 1449264991000)
+++ app/src/main/res/layout/fragment_voir.xml	(revision )
@@ -15,62 +15,61 @@
         android:layout_width="match_parent"
         android:layout_height="0dp"
         android:layout_weight="9"
+        android:gravity="center"
         android:orientation="horizontal">
 
         <LinearLayout
-            android:layout_width="0dp"
-            android:layout_weight="1"
+            android:layout_width="wrap_content"
             android:layout_height="match_parent"
             android:orientation="vertical"
             android:gravity="center_vertical|end">
             <com.farsight.ji.farsightagriclture.Tools.ShowState
-                android:padding="5dp"
+                android:padding="10dp"
                 android:id="@+id/node_env_1"
                 android:layout_width="wrap_content"
                 android:layout_height="wrap_content" />
             <com.farsight.ji.farsightagriclture.Tools.ShowState
                 android:id="@+id/node_soil_1"
-                android:padding="5dp"
+                android:padding="10dp"
                 android:layout_width="wrap_content"
                 android:layout_height="wrap_content" />
             <com.farsight.ji.farsightagriclture.Tools.ShowState
                 android:id="@+id/node_light_1"
-                android:padding="5dp"
+                android:padding="10dp"
                 android:layout_width="wrap_content"
                 android:layout_height="wrap_content" />
             <com.farsight.ji.farsightagriclture.Tools.ShowState
                 android:id="@+id/node_infrered"
-                android:padding="5dp"
+                android:padding="10dp"
                 android:layout_width="wrap_content"
                 android:layout_height="wrap_content" />
 
 
         </LinearLayout>
         <LinearLayout
-            android:layout_width="0dp"
-            android:layout_weight="1"
+            android:layout_width="wrap_content"
             android:layout_height="match_parent"
             android:orientation="vertical"
             android:gravity="center_vertical|start">
 
             <com.farsight.ji.farsightagriclture.Tools.ShowState
-                android:padding="5dp"
+                android:padding="10dp"
                 android:id="@+id/node_env_2"
                 android:layout_width="wrap_content"
                 android:layout_height="wrap_content" />
             <com.farsight.ji.farsightagriclture.Tools.ShowState
                 android:id="@+id/node_soil_2"
-                android:padding="5dp"
+                android:padding="10dp"
                 android:layout_width="wrap_content"
                 android:layout_height="wrap_content" />
             <com.farsight.ji.farsightagriclture.Tools.ShowState
                 android:id="@+id/node_light_2"
-                android:padding="5dp"
+                android:padding="10dp"
                 android:layout_width="wrap_content"
                 android:layout_height="wrap_content" />
             <com.farsight.ji.farsightagriclture.Tools.ShowState
                 android:id="@+id/node_carbon_dioxide"
-                android:padding="5dp"
+                android:padding="10dp"
                 android:layout_width="wrap_content"
                 android:layout_height="wrap_content" />
 
Index: app/src/main/res/layout/fragment_ctrl.xml
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
--- app/src/main/res/layout/fragment_ctrl.xml	(date 1449264991000)
+++ app/src/main/res/layout/fragment_ctrl.xml	(revision )
@@ -9,12 +9,12 @@
         android:layout_width="match_parent"
         android:orientation="horizontal"
         android:layout_height="0dp"
-        android:layout_weight="4"/>
+        android:layout_weight="7"/>
 
     <LinearLayout
         android:layout_width="match_parent"
         android:layout_height="0dp"
-        android:layout_weight="9"
+        android:layout_weight="6"
         android:orientation="horizontal"
         android:gravity="center">
 
@@ -28,6 +28,15 @@
             android:id="@+id/node_humify"
             android:layout_width="wrap_content"
             android:layout_height="wrap_content" />
+
+
+    </LinearLayout>
+    <LinearLayout
+        android:layout_width="match_parent"
+        android:layout_height="0dp"
+        android:layout_weight="6"
+        android:orientation="horizontal"
+        android:gravity="center">
         <com.farsight.ji.farsightagriclture.Tools.CtrlableState
             android:padding="10dp"
             android:id="@+id/node_fan"
@@ -38,20 +47,20 @@
             android:id="@+id/node_lamp"
             android:layout_width="wrap_content"
             android:layout_height="wrap_content" />
-
+        <com.farsight.ji.farsightagriclture.Tools.CtrlableState
+            android:padding="10dp"
+            android:id="@+id/node_drenching"
+            android:layout_width="wrap_content"
+            android:layout_height="wrap_content" />
     </LinearLayout>
     <LinearLayout
         android:layout_width="match_parent"
         android:layout_height="0dp"
-        android:layout_weight="9"
+        android:layout_weight="6"
         android:orientation="horizontal"
         android:gravity="center">
 
-        <com.farsight.ji.farsightagriclture.Tools.CtrlableState
-            android:padding="10dp"
-            android:id="@+id/node_drenching"
-            android:layout_width="wrap_content"
-            android:layout_height="wrap_content" />
+
         <com.farsight.ji.farsightagriclture.Tools.CtrlableState
             android:padding="10dp"
             android:id="@+id/node_shade"
Index: app/src/main/java/com/farsight/ji/farsightagriclture/UI/CtrlFragment.java
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
--- app/src/main/java/com/farsight/ji/farsightagriclture/UI/CtrlFragment.java	(date 1449264991000)
+++ app/src/main/java/com/farsight/ji/farsightagriclture/UI/CtrlFragment.java	(revision )
@@ -79,30 +79,37 @@
     private void initShow() {
         warmNode = (CtrlableState) view.findViewById(R.id.node_warm);
         warmNode.setName(NodeInfo.TYPE_WARM);
+        warmNode.setBitmapdefault(R.drawable.warm);
         setNode(warmNode, 1);
 
         humifyNode = (CtrlableState) view.findViewById(R.id.node_humify);
         humifyNode.setName(NodeInfo.TYPE_HUMIFY);
-        setNode(humifyNode, -2);
+        humifyNode.setBitmapdefault(R.drawable.humify);
+        setNode(humifyNode, 0);
 
         fanNode = (CtrlableState) view.findViewById(R.id.node_fan);
         fanNode.setName(NodeInfo.TYPE_FAN);
+        fanNode.setBitmapdefault(R.drawable.fan);
         setNode(fanNode, -2);
 
         lampNode = (CtrlableState) view.findViewById(R.id.node_lamp);
         lampNode.setName(NodeInfo.TYPE_LAMP);
+        lampNode.setBitmapdefault(R.drawable.lamp);
         setNode(lampNode, -2);
 
         drenchingNode = (CtrlableState) view.findViewById(R.id.node_drenching);
         drenchingNode.setName(NodeInfo.TYPE_DRENCHING);
+        drenchingNode.setBitmapdefault(R.drawable.drenching);
         setNode(drenchingNode, -2);
 
         shadeNode = (CtrlableState) view.findViewById(R.id.node_shade);
         shadeNode.setName(NodeInfo.TYPE_SHADE);
+        shadeNode.setBitmapdefault(R.drawable.shade);
         setNode(shadeNode, -2);
 
         alarmNode = (CtrlableState) view.findViewById(R.id.node_alarm);
         alarmNode.setName(NodeInfo.TYPE_ALARM);
+        alarmNode.setBitmapdefault(R.drawable.alarm);
         setNode(alarmNode, -2);
     }
 
Index: app/src/main/java/com/farsight/ji/farsightagriclture/UI/VoirFragment.java
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
--- app/src/main/java/com/farsight/ji/farsightagriclture/UI/VoirFragment.java	(date 1449264991000)
+++ app/src/main/java/com/farsight/ji/farsightagriclture/UI/VoirFragment.java	(revision )
@@ -91,25 +91,25 @@
         envNodeSecond.invalidate();
 
         soilNodeFirst = (ShowState) view.findViewById(R.id.node_soil_1);
-        soilNodeFirst.setBitmapNode(R.drawable.soil);
+        soilNodeFirst.setBitmapNode(R.drawable.soil1);
         soilNodeFirst.setStrValue("未连接", " ");
         soilNodeFirst.setName(NodeInfo.SOILTEMPFIRST);
         soilNodeFirst.invalidate();
 
         soilNodeSecond = (ShowState) view.findViewById(R.id.node_soil_2);
-        soilNodeSecond.setBitmapNode(R.drawable.soil);
+        soilNodeSecond.setBitmapNode(R.drawable.soil2);
         soilNodeSecond.setStrValue("未连接", " ");
         soilNodeSecond.setName(NodeInfo.SOILTEMPSECOND);
         soilNodeSecond.invalidate();
 
         lightNodeFirst = (ShowState) view.findViewById(R.id.node_light_1);
-        lightNodeFirst.setBitmapNode(R.drawable.light);
+        lightNodeFirst.setBitmapNode(R.drawable.light1);
         lightNodeFirst.setStrValue("未连接", null);
         lightNodeFirst.setName(NodeInfo.LIGHTFIRST);
         lightNodeFirst.invalidate();
 
         lightNodeSecond = (ShowState) view.findViewById(R.id.node_light_2);
-        lightNodeSecond.setBitmapNode(R.drawable.light);
+        lightNodeSecond.setBitmapNode(R.drawable.light2);
         lightNodeSecond.setStrValue("未连接", null);
         lightNodeSecond.setName(NodeInfo.LIGHTSECOND);
         lightNodeSecond.invalidate();
Index: app/src/main/java/com/farsight/ji/farsightagriclture/Tools/ShowState.java
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
--- app/src/main/java/com/farsight/ji/farsightagriclture/Tools/ShowState.java	(date 1449264991000)
+++ app/src/main/java/com/farsight/ji/farsightagriclture/Tools/ShowState.java	(revision )
@@ -86,14 +86,14 @@
     protected void onDraw(Canvas canvas) {
         super.onDraw(canvas);
         canvas.drawBitmap(bitmapNode, rectOri, rectDst, mPaint);
-        canvas.drawText(valueNode1, rectDst.width() / 6, rectDst.bottom - 3, mPaint);
+        canvas.drawText(valueNode1, rectDst.width() / 5, rectDst.bottom - 3, mPaint);
         if (valueNode2 != null) {
-            canvas.drawText(valueNode2, rectDst.width() / 2 + rectDst.width() / 12, rectDst.bottom - 3, mPaint);
+            canvas.drawText(valueNode2, rectDst.width() / 2 + rectDst.width() / 10, rectDst.bottom - 3, mPaint);
         } else {
         }
 
         if (name != null) {
-            canvas.drawText(name, rectDst.width() / 6, rectDst.top + rectDst.height() / 2, mPaint);
+            canvas.drawText(name, rectDst.width() / 5, rectDst.top + rectDst.height() / 2, mPaint);
         }
 
     }
\ No newline at end of file
Index: app/src/main/java/com/farsight/ji/farsightagriclture/Tools/CtrlableState.java
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
--- app/src/main/java/com/farsight/ji/farsightagriclture/Tools/CtrlableState.java	(date 1449264991000)
+++ app/src/main/java/com/farsight/ji/farsightagriclture/Tools/CtrlableState.java	(revision )
@@ -42,37 +42,37 @@
             case NodeInfo.TYPE_WARM:
                 name = NodeInfo.WARM;
                 openCmd = NodeInfo.OPEN_WARM;
-                closeCmd =NodeInfo.CLOSE_WARM;
+                closeCmd = NodeInfo.CLOSE_WARM;
                 break;
             case NodeInfo.TYPE_HUMIFY:
                 name = NodeInfo.HUMIFY;
                 openCmd = NodeInfo.OPEN_HUMIFY;
-                closeCmd =NodeInfo.CLOSE_HUMIFY;
+                closeCmd = NodeInfo.CLOSE_HUMIFY;
                 break;
             case NodeInfo.TYPE_FAN:
                 name = NodeInfo.FAN;
                 openCmd = NodeInfo.OPEN_FAN;
-                closeCmd =NodeInfo.CLOSE_FAN;
+                closeCmd = NodeInfo.CLOSE_FAN;
                 break;
             case NodeInfo.TYPE_LAMP:
                 name = NodeInfo.LAMP;
                 openCmd = NodeInfo.OPEN_LAMP;
-                closeCmd =NodeInfo.CLOSE_LAMP;
+                closeCmd = NodeInfo.CLOSE_LAMP;
                 break;
             case NodeInfo.TYPE_DRENCHING:
                 name = NodeInfo.DRENCHING;
                 openCmd = NodeInfo.OPEN_DRENCHING;
-                closeCmd =NodeInfo.CLOSE_DRENCHING;
+                closeCmd = NodeInfo.CLOSE_DRENCHING;
                 break;
             case NodeInfo.TYPE_SHADE:
                 name = NodeInfo.SHADE;
                 openCmd = NodeInfo.OPEN_SHADE;
-                closeCmd =NodeInfo.CLOSE_SHADE;
+                closeCmd = NodeInfo.CLOSE_SHADE;
                 break;
             case NodeInfo.TYPE_ALARM:
                 name = NodeInfo.ALARM;
                 openCmd = NodeInfo.OPEN_ALARM;
-                closeCmd =NodeInfo.CLOSE_ALARM;
+                closeCmd = NodeInfo.CLOSE_ALARM;
                 break;
         }
     }
@@ -80,16 +80,26 @@
     public void setState(int state) {
         this.state = state;
         if (state == 1) {
+            openDefault = openButtonClicked;
+            closeDefault = closeButton;
-            setStringState("\"开\"" );
+            setStringState("\"开\"");
         } else if (state == 0) {
+            openDefault = openButton;
+            closeDefault = closeButtonClicked;
             setStringState("\"关\"");
-        } else if(state == -1){
+        } else if (state == -1) {
+            openDefault = openButton;
+            closeDefault = closeButtonClicked;
             setStringState("断开连接");
         } else {
             setStringState("未连接");
         }
     }
 
+    public void setBitmapdefault(int bitmapdefault) {
+        this.bitmapdefault = BitmapFactory.decodeResource(mContext.getResources(), bitmapdefault);
+    }
+
     public void setStringState(String state) {
         this.stringState = state;
     }
@@ -112,33 +122,37 @@
         int widthMetrics = context.getResources().getDisplayMetrics().widthPixels;
 
         mPaint = new Paint();
-        mPaint.setTextSize(18);
-        mPaint.setStrokeWidth(Color.WHITE);
+        mPaint.setTextSize(16);
+        mPaint.setColor(Color.BLACK);
         mPaint.setAntiAlias(true);
         mPaint.setFlags(Paint.ANTI_ALIAS_FLAG);
 
         bitmapdefault = BitmapFactory.decodeResource(getResources(), R.drawable.cnode);
-
         int oX, oY, dX, dY;
         oX = bitmapdefault.getWidth();
         oY = bitmapdefault.getHeight();
         rectOri = new Rect(0, 0, oX, oY);
-        dX = widthMetrics / 6;
+        dX = widthMetrics / 12;
         dY = oY * dX / oX;
         rectDst = new Rect(0, 0, dX, dY);
 
+        int oBX, oBY, dBX, dBY;
         openButton = BitmapFactory.decodeResource(getResources(), R.drawable.open);
         openButtonClicked = BitmapFactory.decodeResource(getResources(), R.drawable.open_clicked);
+        oBX = openButton.getWidth();
+        oBY = openButton.getHeight();
+        dBX = rectDst.width();
+        dBY = oBY * dBX / oBX;
         openDefault = openButton;
-        rectOpenOri = new Rect(0, 0, openDefault.getWidth(), openDefault.getHeight());
-        rectOpenDst = new Rect(1, rectDst.height() / 2, rectDst.width() / 2 - 1, rectDst.height() - 1);
+        rectOpenOri = new Rect(0, 0, oBX, oBY);
+        rectOpenDst = new Rect(rectDst.right, rectDst.height() / 2, rectDst.right + dBX, rectDst.height() / 2 + dBY);
 
         closeButton = BitmapFactory.decodeResource(getResources(), R.drawable.close);
         closeButtonClicked = BitmapFactory.decodeResource(getResources(), R.drawable.close_clicked);
         closeDefault = closeButton;
         rectCloseOri = new Rect(0, 0, closeDefault.getWidth(), closeDefault.getHeight());
-        rectCloseDst = new Rect(rectDst.width() / 2 + 1, rectDst.height() / 2, rectDst.width() - 1, rectDst.height()
-                - 1);
+        rectCloseDst = new Rect(rectOpenDst.right, rectDst.height() / 2, rectOpenDst.right + dBX,
+                rectDst.height() / 2 + dBY);
 
         openCmd = NodeInfo.OPEN;
         closeCmd = NodeInfo.CLOSE;
@@ -150,11 +164,12 @@
         canvas.drawBitmap(bitmapdefault, rectOri, rectDst, mPaint);
         canvas.drawBitmap(openDefault, rectOpenOri, rectOpenDst, mPaint);
         canvas.drawBitmap(closeDefault, rectCloseOri, rectCloseDst, mPaint);
+
         if (name != null) {
-            canvas.drawText(name, rectDst.left + 1, rectDst.height() / 4, mPaint);
+            canvas.drawText(name, rectOpenDst.left, rectDst.height() / 3, mPaint);
         }
         if (stringState != null) {
-            canvas.drawText(stringState, rectDst.left + 1, rectDst.height() / 2, mPaint);
+            canvas.drawText(stringState, rectOpenDst.right + 1, rectDst.height() / 3, mPaint);
         }
 
     }
@@ -170,7 +185,7 @@
         if (widthMode == MeasureSpec.EXACTLY) {
             width = widthSize;
         } else {
-            int desired = (int) (getPaddingLeft() + getPaddingRight() + rectDst.width());
+            int desired = (int) (getPaddingLeft() + getPaddingRight() + rectDst.width() + 2 * rectOpenDst.width());
             width = desired;
         }
 
@@ -190,16 +205,21 @@
         switch (event.getAction()) {
             case MotionEvent.ACTION_DOWN:
                 if (x > rectOpenDst.left && x < rectOpenDst.right && y > rectOpenDst.top && y < rectOpenDst.bottom) {
+                    if (state == 0) {
-                    openDefault = openButtonClicked;
+                        openDefault = openButtonClicked;
+                    }
                 } else if (x > rectCloseDst.left && x < rectCloseDst.right && y > rectCloseDst.top && y < rectCloseDst
                         .bottom) {
+                    if (state == 1) {
-                    closeDefault = closeButtonClicked;
-                }
+                        closeDefault = closeButtonClicked;
+                    }
+                }
                 break;
             case MotionEvent.ACTION_UP:
                 if (x > rectOpenDst.left && x < rectOpenDst.right && y > rectOpenDst.top && y < rectOpenDst.bottom) {
-                    openDefault = openButton;
+
                     if (state == 0) {
+                        openDefault = openButton;
                         try {
                             TotalDatas.qSend.put(openCmd);
                             Log.d("put", StringTool.hexToString(openCmd) + name);
@@ -209,8 +229,8 @@
                     }
                 } else if (x > rectCloseDst.left && x < rectCloseDst.right && y > rectCloseDst.top && y < rectCloseDst
                         .bottom) {
-                    closeDefault = closeButton;
                     if (state == 1) {
+                        closeDefault = closeButton;
                         try {
                             TotalDatas.qSend.put(closeCmd);
                             Log.d("put", StringTool.hexToString(closeCmd) + name);
